<!DOCTYPE HTML>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <title>MySql操作之表篇 - Dreamcatcher</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
  
  <meta name="description" content="一些基本的操作">
  
  <meta itemprop="name" content="MySql操作之表篇 - Dreamcatcher">
  <meta itemprop="description" content="一些基本的操作">
  
  <meta itemprop="image" content="https://lpgph.github.io/img/author.jpg">

  
  
  <meta name="twitter:description" content="曾梦想仗剑走天涯">
  
  
  <link rel="shortcut icon" href="https://lpgph.github.io/img/favicon.ico"/>
  <link rel="apple-touch-icon" href="https://lpgph.github.io/img/apple-touch-icon.png" />
  <link rel="apple-touch-icon-precomposed" href="https://lpgph.github.io/img/apple-touch-icon.png" />

  
  
  <link rel="stylesheet" href="https://lpgph.github.io/font/hack/css/hack.min.css">
  <link rel="stylesheet" href="https://lpgph.github.io/font/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://lpgph.github.io/font/playball/playball.css">

  <link rel="stylesheet" href="https://lpgph.github.io/css/style.css">	
  <script type="text/javascript"> 
    var $BaseURL = "https://lpgph.github.io/";
  </script>
  
  
  <script type="text/javascript"> 
    var $live2d_widget_model = "/plugin/live2d-widget/model/kesyoban/kesyoban.model.json";
  </script>
  <script src="https://lpgph.github.io/plugin/live2d-widget/js/L2Dwidget.min.js"></script>
   

  <script src="https://lpgph.github.io/js/spring-loaders.js"></script>
  
  
  <link rel="stylesheet" href="https://lpgph.github.io/plugin/highlight/styles/github.css">
  <script src="https://lpgph.github.io/plugin/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script src="https://lpgph.github.io/js/jquery-3.3.1.min.js"></script>
  
  
  <script type="text/javascript" src="https://lpgph.github.io/js/click_show_text.js"></script>
  
  
  <script src="https://lpgph.github.io/js/motto-show.js"></script>

</head>
<body>
    <div id="home" class="app-home">
        <aside>
             
  <button class="navbutton"  id="openaside" title="显示侧边栏">
    <i class="fa fa-navicon"></i>  
    <span id="nav-btn-title" style="padding-left: 10px;">MENU</span>
  </button>
  <div id="asidepart" class="asidepart">
    <button class="close-button"  id="closeaside" title="隐藏侧边栏">
      <i class="fa fa-close"></i>
    </button>
    <div class="aside-info">
      <div class="blog-info">
  
  <div class="blog-avatar">
    <a href="https://lpgph.github.io/">
      <img src="https://lpgph.github.io/img/avatar.jpg" alt="lpgph" title="lpgph"/>
    </a>
  </div>
  
  <div class="blog-author-info">
    <h1 class="blog-author"><a href="https://lpgph.github.io/" title="lpgph">lpgph</a></h1>
    <h2 class="blog-motto" id="blog-motto"></h2>

    <script>
     
      binft(document.getElementById('blog-motto'),["青青陵上柏，磊磊涧中石","人生天地间，忽如远行客","斗酒相娱乐，聊厚不为薄","驱车策驽马，游戏宛与洛","洛中何郁郁，冠带自相索","长衢罗夹巷，王侯多第宅","两宫遥相望，双阙百余尺","极宴娱心意，戚戚何所迫？"]);
    
    </script>
  </div>
  <nav class="animated">
    <ul>
      
      <li><a href="/">主页</a></li>
      
      <li><a href="/post/">归档</a></li>
      
      <li><a href="/categories/">分类</a></li>
      
      <li><a href="/tags/">标签云</a></li>
      
      <li><a href="/categories/learn/">笔记</a></li>
      
      <li><a href="/categories/notes/">记录</a></li>
      
      <li><a href="/categories/booklist/">书单</a></li>
      
      <li><a href="/about/">关于我</a></li>
      
    </ul>
    <h1 class="asidetitle">搜索</h1>
    <form class="search" method="get" action="https://www.google.com/search">
        <input type="text" id="search" name="q" placeholder="搜索">
    </form>
  </nav>
</div>
      

<div class="categorieslist">
  <h1 class="asidetitle">分类</h1>
  <ul class="side-info-list">
    
    <li><a href="https://lpgph.github.io/categories/java" title="java">java<sup>(1)</sup></a></li>
    
    <li><a href="https://lpgph.github.io/categories/mysql" title="mysql">mysql<sup>(7)</sup></a></li>
    
    <li><a href="https://lpgph.github.io/categories/%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f" title="设计模式">设计模式<sup>(1)</sup></a></li>
    
  </ul>
</div>



      

	
	<div class="tagslist">
		<h1 class="asidetitle">标签</h1>
		<ul class="side-info-list">
			
			<li><a href="https://lpgph.github.io/tags/java" title="java">java<sup>(2)</sup></a></li>
			
			<li><a href="https://lpgph.github.io/tags/mysql" title="mysql">mysql<sup>(7)</sup></a></li>
			
			<li><a href="https://lpgph.github.io/tags/quartz" title="quartz">quartz<sup>(1)</sup></a></li>
			
			<li><a href="https://lpgph.github.io/tags/spring" title="spring">spring<sup>(1)</sup></a></li>
			
			<li><a href="https://lpgph.github.io/tags/%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f" title="设计模式">设计模式<sup>(1)</sup></a></li>
			
		</ul>
	</div>
	

      

  <div class="social-list">
  	<h1 class="asidetitle">社交</h1>
    <div class="social-info">
      
      
      
        <a href="https://github.com/lpgph" target="_blank" title="github"></a>
      
      
      
    </div>
  </div>
  

    </div>
  </div>
  <div id="sideBar" class="app-menu"></div>
        </aside>

        <header>
         
    <header class="app-header article-header" id="app-header">
      
<div class="vertical">
  <div class="inner">
      <h1 itemprop="name" class="article-title">
        <a href="https://lpgph.github.io/post/mysql_table/" title="MySql操作之表篇" itemprop="url">MySql操作之表篇</a>
      </h1>
      <h2 class="article-info">
        <p class="article-info-text">
          Posted by
          
            <a href="http://localhost:1313/" title="lpgph">lpgph</a>
          
          on <time datetime="2018-03-03 13:37:02 &#43;0000 UTC" itemprop="datePublished">2018-03-03</time>
        </p>
        <p class="article-tags">
          
          
            
            <span class="article-tag  article-category-color">
              <i class="fa fa-th-large" aria-hidden="true"></i>
              <a href="https://lpgph.github.io/categories/mysql">MySql</a>
            </span>
            
          
          

          
          
            
            <span class="article-tag  article-tag-color">
              <i class="fa fa-tag" aria-hidden="true"></i>
              <a href="https://lpgph.github.io/tags/mysql">MySql</a>
            </span>
            
          
          
        </p>
      </h2>
  </div>
</div>
    </header>

        </header>
        
        <main id="main-content" class="app container">
            
      
  <div id="main" class="post"> 

    
  <div  class="article-content box-style box-first">
    <article>
      <p>一些基本的操作</p>
<p>[Mysql官方文档] (<a href="https://dev.mysql.com/doc/refman/5.7/en/select.html">https://dev.mysql.com/doc/refman/5.7/en/select.html</a> &ldquo;Mysql官方文档&rdquo;)</p>
<h2 id="heading">创建和删除</h2>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">/</span><span class="o">/</span><span class="err">创</span><span class="err">建</span><span class="err">表</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span><span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="p">,</span><span class="n">field2</span><span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">]</span><span class="p">)</span> <span class="k">comment</span><span class="o">=</span><span class="s1">&#39;</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span><span class="n">eg</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">table</span> <span class="k">user</span><span class="p">(</span>
<span class="o">&gt;</span> <span class="n">id</span> <span class="nb">int</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span> <span class="k">primary</span> <span class="k">key</span> <span class="n">auto_increment</span><span class="p">,</span>
<span class="o">&gt;</span> <span class="n">name</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
<span class="o">&gt;</span> <span class="n">sex</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span> <span class="k">default</span> <span class="s1">&#39;</span><span class="s1">0</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="o">&gt;</span> <span class="n">weight</span> <span class="n">double</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="p">)</span> <span class="k">comment</span><span class="o">=</span><span class="s1">&#39;</span><span class="s1">用户表</span><span class="s1">&#39;</span><span class="p">;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">/</span><span class="o">/</span><span class="err">删</span><span class="err">除</span><span class="err">表</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">drop</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">/</span><span class="o">/</span><span class="err">修</span><span class="err">改</span><span class="err">表</span><span class="err">名</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">rename</span> <span class="k">table</span> <span class="o">&lt;</span><span class="n">old_table_name</span><span class="o">&gt;</span> <span class="k">to</span> <span class="o">&lt;</span><span class="n">new_table_name</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div><h2 id="heading1">查看表</h2>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SHOW</span> <span class="n">DATABASES</span>                                <span class="o">/</span><span class="o">/</span><span class="err">列</span><span class="err">出</span> <span class="n">MySQL</span> <span class="n">Server</span> <span class="err">数</span><span class="err">据</span><span class="err">库</span><span class="err">。</span>
<span class="k">SHOW</span> <span class="n">TABLES</span> <span class="p">[</span><span class="k">FROM</span> <span class="n">db_name</span><span class="p">]</span>                    <span class="o">/</span><span class="o">/</span><span class="err">列</span><span class="err">出</span><span class="err">数</span><span class="err">据</span><span class="err">库</span><span class="err">数</span><span class="err">据</span><span class="err">表</span><span class="err">。</span>
<span class="k">SHOW</span> <span class="k">TABLE</span> <span class="n">STATUS</span> <span class="p">[</span><span class="k">FROM</span> <span class="n">db_name</span><span class="p">]</span>              <span class="o">/</span><span class="o">/</span><span class="err">列</span><span class="err">出</span><span class="err">数</span><span class="err">据</span><span class="err">表</span><span class="err">及</span><span class="err">表</span><span class="err">状</span><span class="err">态</span><span class="err">信</span><span class="err">息</span><span class="err">。</span>
<span class="k">SHOW</span> <span class="n">COLUMNS</span> <span class="k">FROM</span> <span class="n">tbl_name</span> <span class="p">[</span><span class="k">FROM</span> <span class="n">db_name</span><span class="p">]</span>     <span class="o">/</span><span class="o">/</span><span class="err">列</span><span class="err">出</span><span class="err">资</span><span class="err">料</span><span class="err">表</span><span class="err">字</span><span class="err">段</span>
<span class="k">SHOW</span> <span class="n">FIELDS</span> <span class="k">FROM</span> <span class="n">tbl_name</span> <span class="p">[</span><span class="k">FROM</span> <span class="n">db_name</span><span class="p">]</span>
<span class="k">DESCRIBE</span> <span class="n">tbl_name</span> <span class="p">[</span><span class="n">col_name</span><span class="p">]</span>                  <span class="o">/</span><span class="o">/</span><span class="err">可</span><span class="err">以</span><span class="err">简</span><span class="err">写</span><span class="err">为</span><span class="err">：</span> <span class="k">DESC</span> <span class="n">tbl_name</span> <span class="p">[</span><span class="n">col_name</span><span class="p">]</span>
<span class="k">SHOW</span> <span class="k">FULL</span> <span class="n">COLUMNS</span> <span class="k">FROM</span> <span class="n">tbl_name</span> <span class="p">[</span><span class="k">FROM</span> <span class="n">db_name</span><span class="p">]</span><span class="o">/</span><span class="o">/</span><span class="err">列</span><span class="err">出</span><span class="err">字</span><span class="err">段</span><span class="err">及</span><span class="err">详</span><span class="err">情</span>
<span class="k">SHOW</span> <span class="k">FULL</span> <span class="n">FIELDS</span> <span class="k">FROM</span> <span class="n">tbl_name</span> <span class="p">[</span><span class="k">FROM</span> <span class="n">db_name</span><span class="p">]</span> <span class="o">/</span><span class="o">/</span><span class="err">列</span><span class="err">出</span><span class="err">字</span><span class="err">段</span><span class="err">完</span><span class="err">整</span><span class="err">属</span><span class="err">性</span>
<span class="k">SHOW</span> <span class="k">INDEX</span> <span class="k">FROM</span> <span class="n">tbl_name</span> <span class="p">[</span><span class="k">FROM</span> <span class="n">db_name</span><span class="p">]</span>       <span class="o">/</span><span class="o">/</span><span class="err">列</span><span class="err">出</span><span class="err">表</span><span class="err">索</span><span class="err">引</span><span class="err">。</span>
<span class="k">SHOW</span> <span class="n">STATUS</span>                                  <span class="o">/</span><span class="o">/</span><span class="err">列</span><span class="err">出</span> <span class="n">DB</span> <span class="n">Server</span> <span class="err">状</span><span class="err">态</span><span class="err">。</span>
<span class="k">SHOW</span> <span class="n">VARIABLES</span>                               <span class="o">/</span><span class="o">/</span><span class="err">列</span><span class="err">出</span> <span class="n">MySQL</span> <span class="err">系</span><span class="err">统</span><span class="err">环</span><span class="err">境</span><span class="err">变</span><span class="err">量</span><span class="err">。</span>
<span class="k">SHOW</span> <span class="n">PROCESSLIST</span>                             <span class="o">/</span><span class="o">/</span><span class="err">列</span><span class="err">出</span><span class="err">执</span><span class="err">行</span><span class="err">命</span><span class="err">令</span><span class="err">。</span>
<span class="k">SHOW</span> <span class="n">GRANTS</span> <span class="k">FOR</span> <span class="k">user</span>                         <span class="o">/</span><span class="o">/</span><span class="err">列</span><span class="err">出</span><span class="err">某</span><span class="err">用</span><span class="err">户</span><span class="err">权</span><span class="err">限</span>
</code></pre></div><h2 id="heading2">表字段</h2>
<h3 id="heading3">常用字段属性:</h3>
<table>
<thead>
<tr>
<th>属性</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>auto_increment</td>
<td>为新插入的行赋一个唯一的整数标识符,自动递增,作为主键列，每个表只允许有一个自动递增列</td>
</tr>
<tr>
<td>binary</td>
<td>区分大小写的方式排序</td>
</tr>
<tr>
<td>default</td>
<td>属性确保在没有任何值可用的情况下，赋予某个常量值，这个值必须是常量，因为MySQL不允许插入函数或表达式值。此外，此属性无法用于BLOB或TEXT列。如果已经为此列指定了NULL属性，没有指定默认值时默认值将为NULL，否则默认值将依赖于字段的数据类型</td>
</tr>
<tr>
<td>index</td>
<td>如果所有其他因素都相同，要加速数据库查询，使用索引通常是最重要的一个步骤。索引一个列会为该列创建一个有序的键数组，每个键指向其相应的表行。以后针对输入条件可以搜索这个有序的键数组，与搜索整个未索引的表相比，这将在性能方面得到极大的提升。<strong>在实践中尽量使用小的索引。</strong></td>
</tr>
<tr>
<td>not null</td>
<td>如果将一个列定义为not null，将不允许向该列插入null值。<strong>建议在重要情况下始终使用not null属性</strong>，因为它提供了一个基本验证，确保已经向查询传递了所有必要的值。</td>
</tr>
<tr>
<td>null</td>
<td>为列指定null属性时，该列可以保持为空，而不论行中其它列是否已经被填充。记住，<strong>null精确的说法是“无”，而不是空字符串或0。</strong></td>
</tr>
<tr>
<td>primary key</td>
<td>用于确保指定行的唯一性。指定为主键的列中，值不能重复，也不能为空。为指定为主键的列赋予auto_increment属性是很常见的，因为此列不必与行数据有任何关系，而只是作为一个唯一标识符。作为主键又分两种：<!-- raw HTML omitted -->(1) 单字段主键 如果输入到数据库中的每行都已经有不可修改的唯一标识符，一般会使用单字段主键。注意，此主键一旦设置就不能再修改。<!-- raw HTML omitted -->(2) 多字段主键如果记录中任何一个字段都不可能保证唯一性，就可以使用多字段主键。这时，多个字段联合起来确保唯一性。如果出现这种情况，指定一个auto_increment整数作为主键是更好的办法。</td>
</tr>
<tr>
<td>unique</td>
<td>被赋予unique属性的列将确保所有值都有不同的值，只是null值可以重复。一般会指定一个列为unique，以确保该列的所有值都不同。</td>
</tr>
<tr>
<td>zerofill</td>
<td>可用于任何数值类型，用0填充所有剩余字段空间。例如，无符号int的默认宽度是10；因此，当“零填充”的int值为4时，将表示它为0000000004。</td>
</tr>
<tr>
<td>character set</td>
<td>指定一个字符集</td>
</tr>
</tbody>
</table>
<h3 id="heading4">添加字段</h3>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span> <span class="k">add</span> <span class="o">&lt;</span><span class="n">field_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">field_type</span><span class="o">&gt;</span> <span class="k">comment</span> <span class="s2">&#34;</span><span class="s2">备注</span><span class="s2">&#34;</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span><span class="n">eg</span><span class="p">:</span><span class="err">在</span><span class="err">表</span><span class="n">user添加了一个字段update_time</span><span class="err">，</span><span class="err">类</span><span class="err">型</span><span class="err">为</span><span class="k">timestamp</span><span class="err">，</span><span class="err">设</span><span class="err">置</span><span class="err">创</span><span class="err">建</span><span class="err">时</span><span class="err">间</span><span class="err">和</span><span class="err">默</span><span class="err">认</span><span class="err">时</span><span class="err">间</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="k">user</span> <span class="k">add</span> <span class="n">update_time</span> <span class="k">timestamp</span> <span class="k">default</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">comment</span><span class="o">=</span><span class="s1">&#39;</span><span class="s1">更新时间</span><span class="s1">&#39;</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span> <span class="err">在</span><span class="n">log表中</span> <span class="err">添</span><span class="err">加</span><span class="err">一</span><span class="err">个</span><span class="n">state字段并且放在current_count后</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">log</span> <span class="k">ADD</span> <span class="o">`</span><span class="k">state</span><span class="o">`</span> <span class="n">TINYINT</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">UNSIGNED</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="mi">0</span> <span class="k">COMMENT</span> <span class="s2">&#34;</span><span class="s2">状态，0 待审核，1已审核，2拒绝</span><span class="s2">&#34;</span> <span class="k">AFTER</span> <span class="n">current_count</span><span class="p">;</span>
</code></pre></div><h3 id="heading5">修改字段</h3>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span> <span class="n">change</span> <span class="o">&lt;</span><span class="n">old_table</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">new_table</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">field_type</span><span class="o">&gt;</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span><span class="n">eg</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="k">user</span> <span class="n">change</span> <span class="n">weight</span> <span class="n">height</span> <span class="n">double</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><h3 id="heading6">删除字段</h3>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="err">删</span><span class="err">除</span><span class="err">字</span><span class="err">段</span><span class="err">：</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span> <span class="k">drop</span> <span class="o">&lt;</span><span class="n">field_name</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div><h3 id="heading7">添加索引</h3>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">/</span><span class="o">/</span><span class="err">一</span><span class="err">般</span><span class="err">索</span><span class="err">引</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span> <span class="k">add</span> <span class="k">index</span> <span class="o">&lt;</span><span class="n">index_name</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">field_name</span><span class="p">[</span><span class="p">,</span><span class="n">field_name2</span><span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">]</span><span class="p">)</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span><span class="n">eg</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="k">user</span> <span class="k">add</span> <span class="k">index</span> <span class="n">u_name</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">sex</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">/</span><span class="o">/</span><span class="err">加</span><span class="err">主</span><span class="err">关</span><span class="err">键</span><span class="err">字</span><span class="err">的</span><span class="err">索</span><span class="err">引</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span> <span class="k">add</span> <span class="k">primary</span> <span class="k">key</span> <span class="o">&lt;</span><span class="n">field_name</span><span class="o">&gt;</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span><span class="n">eg</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="k">user</span> <span class="k">add</span> <span class="k">primary</span> <span class="k">key</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">/</span><span class="o">/</span><span class="err">加</span><span class="err">唯</span><span class="err">一</span><span class="err">限</span><span class="err">制</span><span class="err">条</span><span class="err">件</span><span class="err">的</span><span class="err">索</span><span class="err">引</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span> <span class="k">add</span> <span class="k">unique</span> <span class="o">&lt;</span><span class="n">index_name</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">field_name</span><span class="p">)</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span><span class="n">eg</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="k">user</span> <span class="k">add</span> <span class="k">unique</span> <span class="n">u_name</span><span class="p">(</span><span class="n">cardnumber</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><h3 id="heading8">删除索引</h3>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span> <span class="k">drop</span> <span class="k">index</span> <span class="o">&lt;</span><span class="n">index_name</span><span class="o">&gt;</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span><span class="n">eg</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="k">user</span> <span class="k">drop</span> <span class="k">index</span> <span class="n">u_name</span><span class="p">;</span>
</code></pre></div><h2 id="insert">insert语法</h2>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">INSERT</span> <span class="p">[</span> <span class="n">LOW_PRIORITY</span> <span class="o">|</span> <span class="n">DELAYED</span> <span class="o">|</span> <span class="n">HIGH_PRIORITY</span> <span class="p">]</span> <span class="p">[</span> <span class="k">IGNORE</span> <span class="p">]</span> <span class="p">[</span> <span class="k">INTO</span> <span class="p">]</span> <span class="n">tbl_name</span> <span class="p">[</span> <span class="n">PARTITION</span> <span class="p">(</span>
	<span class="n">partition_name</span> <span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">)</span> <span class="p">]</span> <span class="p">[</span> <span class="p">(</span>
		<span class="n">col_name</span> <span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">)</span> <span class="p">]</span> <span class="err">{</span>
		<span class="k">VALUES</span>
			<span class="o">|</span>
		<span class="n">VALUE</span>
			<span class="err">}</span> <span class="p">(</span><span class="err">{</span> <span class="n">expr</span> <span class="o">|</span> <span class="k">DEFAULT</span> <span class="err">}</span><span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">)</span><span class="p">,</span><span class="p">(</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">)</span> <span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">[</span> <span class="k">ON</span> <span class="n">DUPLICATE</span> <span class="k">KEY</span> <span class="k">UPDATE</span> <span class="n">col_name</span> <span class="o">=</span> <span class="n">expr</span> <span class="p">[</span><span class="p">,</span> <span class="n">col_name</span> <span class="o">=</span> <span class="n">expr</span> <span class="p">]</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">]</span>

<span class="o">/</span><span class="o">/</span><span class="n">eg1</span> <span class="err">单</span><span class="err">条</span><span class="err">插</span><span class="err">入</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">INSERT</span> <span class="k">INTO</span> <span class="k">user</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="n">VALUE</span> <span class="p">(</span><span class="s2">&#34;</span><span class="s2">张三</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span><span class="n">eg2</span> <span class="err">多</span><span class="err">条</span><span class="err">插</span><span class="err">入</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">INSERT</span> <span class="k">INTO</span> <span class="k">user</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s2">&#34;</span><span class="s2">张三</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span><span class="p">,</span><span class="p">(</span><span class="s2">&#34;</span><span class="s2">李四</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span><span class="p">,</span><span class="p">(</span><span class="s2">&#34;</span><span class="s2">王五</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><p>or</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">/</span><span class="o">/</span><span class="err">只</span><span class="err">能</span><span class="err">插</span><span class="err">入</span><span class="err">一</span><span class="err">条</span>
<span class="k">INSERT</span> <span class="p">[</span> <span class="n">LOW_PRIORITY</span> <span class="o">|</span> <span class="n">DELAYED</span> <span class="o">|</span> <span class="n">HIGH_PRIORITY</span> <span class="p">]</span> <span class="p">[</span> <span class="k">IGNORE</span> <span class="p">]</span> <span class="p">[</span> <span class="k">INTO</span> <span class="p">]</span> <span class="n">tbl_name</span> <span class="p">[</span> <span class="n">PARTITION</span> <span class="p">(</span>
	<span class="n">partition_name</span> <span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">)</span> <span class="p">]</span>
	<span class="k">SET</span> <span class="n">col_name</span> <span class="o">=</span><span class="err">{</span> <span class="n">expr</span> <span class="o">|</span> <span class="k">DEFAULT</span> <span class="err">}</span><span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">[</span> <span class="k">ON</span> <span class="n">DUPLICATE</span> <span class="k">KEY</span> <span class="k">UPDATE</span> <span class="n">col_name</span> <span class="o">=</span> <span class="n">expr</span> <span class="p">[</span><span class="p">,</span> <span class="n">col_name</span> <span class="o">=</span> <span class="n">expr</span> <span class="p">]</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">]</span>

<span class="o">/</span><span class="o">/</span><span class="n">eg</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">INSERT</span> <span class="k">INTO</span> <span class="k">user</span> <span class="k">set</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">张三</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">18</span><span class="p">;</span>
</code></pre></div><p>or</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">/</span><span class="o">/</span><span class="err">用</span><span class="err">于</span><span class="err">表</span><span class="err">复</span><span class="err">制</span>
<span class="k">INSERT</span> <span class="p">[</span> <span class="n">LOW_PRIORITY</span> <span class="o">|</span> <span class="n">HIGH_PRIORITY</span> <span class="p">]</span> <span class="p">[</span> <span class="k">IGNORE</span> <span class="p">]</span> <span class="p">[</span> <span class="k">INTO</span> <span class="p">]</span> <span class="n">tbl_name</span> <span class="p">[</span> <span class="n">PARTITION</span> <span class="p">(</span>
	<span class="n">partition_name</span> <span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">)</span> <span class="p">]</span> <span class="p">[</span> <span class="p">(</span>
		<span class="n">col_name</span> <span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">)</span> <span class="p">]</span> <span class="k">SELECT</span>
			<span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">[</span> <span class="k">ON</span> <span class="n">DUPLICATE</span> <span class="k">KEY</span> <span class="k">UPDATE</span> <span class="n">col_name</span> <span class="o">=</span> <span class="n">expr</span> <span class="p">[</span><span class="p">,</span> <span class="n">col_name</span> <span class="o">=</span> <span class="n">expr</span> <span class="p">]</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">]</span>
			
<span class="o">/</span><span class="o">/</span><span class="n">eg1</span> <span class="err">两</span><span class="err">个</span><span class="err">表</span><span class="err">数</span><span class="err">据</span><span class="err">互</span><span class="err">通</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">a</span><span class="p">(</span><span class="n">a_field1</span><span class="p">,</span><span class="n">a_field2</span><span class="p">)</span> <span class="k">SELECT</span> <span class="n">b_field1</span><span class="p">,</span><span class="n">b_field2</span> <span class="k">FROM</span> <span class="n">b</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span><span class="n">eg2</span> <span class="err">多</span><span class="err">张</span><span class="err">表</span><span class="err">进</span><span class="err">行</span><span class="err">复</span><span class="err">制</span><span class="p">,</span><span class="err">需</span><span class="err">要</span><span class="err">先</span><span class="err">使</span><span class="err">用</span><span class="err">关</span><span class="err">联</span><span class="err">查</span><span class="err">询</span><span class="err">查</span><span class="err">出</span><span class="err">数</span><span class="err">据</span><span class="err">后</span><span class="err">再</span><span class="err">插</span><span class="err">入</span><span class="p">,</span><span class="err">嵌</span><span class="err">套</span><span class="err">部</span><span class="err">分</span><span class="err">需</span><span class="err">要</span><span class="err">设</span><span class="err">置</span><span class="err">别</span><span class="err">名</span><span class="err">！</span><span class="err">！</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">a</span><span class="p">(</span><span class="n">a_field1</span><span class="p">,</span><span class="n">a_field2</span><span class="p">)</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span><span class="p">(</span><span class="k">SELECT</span> <span class="n">f1</span><span class="p">,</span><span class="n">f2</span> <span class="k">FROM</span> <span class="n">b</span> <span class="k">JOIN</span> <span class="k">c</span><span class="p">)</span> <span class="k">AS</span> <span class="n">tb</span><span class="p">;</span>
</code></pre></div><h2 id="update">update语法</h2>
<h3 id="heading9">单条更新：</h3>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">UPDATE</span> <span class="p">[</span> <span class="n">LOW_PRIORITY</span> <span class="p">]</span> <span class="p">[</span> <span class="k">IGNORE</span> <span class="p">]</span> <span class="n">table_reference</span>
<span class="k">SET</span> <span class="n">col_name1</span> <span class="o">=</span><span class="err">{</span> <span class="n">expr1</span> <span class="o">|</span> <span class="k">DEFAULT</span> <span class="err">}</span> <span class="p">[</span><span class="p">,</span> <span class="n">col_name2</span> <span class="o">=</span><span class="err">{</span> <span class="n">expr2</span> <span class="o">|</span> <span class="k">DEFAULT</span> <span class="err">}</span><span class="p">]</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">[</span>
<span class="k">WHERE</span>
	<span class="n">where_condition</span> <span class="p">]</span> <span class="p">[</span>
<span class="k">ORDER</span> <span class="k">BY</span>
	<span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">]</span> <span class="p">[</span>
<span class="k">LIMIT</span> <span class="k">row_count</span> <span class="p">]</span>

<span class="o">#</span> <span class="n">eg1</span> <span class="err">单</span><span class="err">表</span><span class="err">更</span><span class="err">新</span><span class="p">:</span>
<span class="k">UPDATE</span> <span class="k">user</span> <span class="k">SET</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;</span><span class="s2">李四</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">age</span><span class="o">=</span><span class="mi">19</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

<span class="o">#</span> <span class="n">eg2</span> <span class="err">多</span><span class="err">表</span><span class="err">更</span><span class="err">新</span><span class="p">:</span>
<span class="k">UPDATE</span> <span class="k">USER</span> <span class="n">u</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">user_info</span> <span class="n">ui</span> <span class="k">ON</span> <span class="n">u</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">ui_user_id</span>
<span class="k">SET</span> <span class="n">ui_age</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">WHERE</span>
	<span class="n">u</span><span class="p">.</span><span class="n">sex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div><h3 id="heading10">多条更新：</h3>
<p>由于mysql并没有提供多条更新语句，所以进行批量更新网上有三种方法：</p>
<ol>
<li>
<p>在程序中批量update，一条记录update一次，性能很差</p>
</li>
<li>
<p>使用replace into 或者insert into &hellip;on duplicate key update，性能较好</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">/</span><span class="o">/</span><span class="n">eg1</span><span class="err">：</span><span class="k">replace</span> <span class="k">into</span> <span class="p">(</span><span class="err">操</span><span class="err">作</span><span class="err">本</span><span class="err">质</span><span class="err">是</span><span class="err">对</span><span class="err">重</span><span class="err">复</span><span class="err">的</span><span class="err">记</span><span class="err">录</span><span class="err">先</span><span class="n">delete后insert</span><span class="err">，</span><span class="err">如</span><span class="err">果</span><span class="err">更</span><span class="err">新</span><span class="err">的</span><span class="err">字</span><span class="err">段</span><span class="err">不</span><span class="err">全</span><span class="err">会</span><span class="err">将</span><span class="err">缺</span><span class="err">失</span><span class="err">的</span><span class="err">字</span><span class="err">段</span><span class="err">置</span><span class="err">为</span><span class="err">缺</span><span class="err">省</span><span class="err">值</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">replace</span> <span class="k">into</span> <span class="k">user</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">age</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="s2">&#34;</span><span class="s2">张三</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="p">,</span><span class="p">(</span><span class="s2">&#34;</span><span class="s2">李四</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="p">,</span><span class="p">(</span><span class="s2">&#34;</span><span class="s2">王五</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span><span class="n">eg2</span><span class="err">：</span><span class="k">insert</span> <span class="k">into</span> <span class="p">(</span><span class="err">操</span><span class="err">作</span><span class="err">本</span><span class="err">质</span><span class="err">是</span><span class="err">只</span><span class="n">update重复记录</span><span class="err">，</span><span class="err">不</span><span class="err">会</span><span class="err">改</span><span class="err">变</span><span class="err">其</span><span class="err">它</span><span class="err">字</span><span class="err">段</span><span class="err">。</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">insert</span> <span class="k">into</span> <span class="k">user</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&#34;</span><span class="s2">张三</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="p">,</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&#34;</span><span class="s2">李四</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="p">,</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&#34;</span><span class="s2">王五</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span> <span class="k">on</span> <span class="n">duplicate</span> <span class="k">key</span> <span class="k">update</span> <span class="n">name</span><span class="o">=</span><span class="k">values</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="k">values</span><span class="p">(</span><span class="n">age</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><p>两者异同
相同之处:</p>
<blockquote>
<p>(1) 没有key的时候，replace与insert .. on deplicate udpate相同。
(2) 有key的时候，都保留主键值，并且auto_increment自动+1</p>
</blockquote>
<p>不同之处：</p>
<blockquote>
<p>有key的时候，replace是delete老记录，而录入新的记录，所以原有的所有记录会被清除，这个时候，如果replace语句的字段不全的话，有些原有的字段的值会被自动填充为默认值。
而insert .. duplicate update则只执行update标记之后的sql，从表象上来看相当于一个简单的update语句。所以两者的区别只有一个，insert .. on duplicate udpate保留了所有字段的旧值，再覆盖然后一起insert进去，而replace没有保留旧值，直接删除再insert新值。</p>
</blockquote>
<p>从底层执行效率上来讲，replace要比insert .. on duplicate update效率要高，但是在写replace的时候，字段要写全，防止老的字段数据被删除。</p>
</li>
<li>
<p>创建临时表，先更新临时表，然后从临时表中update，性能最好</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">/</span><span class="o">/</span><span class="err">注</span><span class="err">意</span><span class="err">：</span><span class="err">这</span><span class="err">种</span><span class="err">方</span><span class="err">法</span><span class="err">需</span><span class="err">要</span><span class="err">用</span><span class="err">户</span><span class="err">有</span><span class="k">temporary</span> <span class="err">表</span><span class="err">的</span><span class="k">create</span> <span class="err">权</span><span class="err">限</span><span class="err">。</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">temporary</span> <span class="k">table</span> <span class="n">tmp</span><span class="p">(</span><span class="n">id</span> <span class="nb">int</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span><span class="n">name</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="p">,</span> <span class="n">age</span> <span class="nb">int</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="p">)</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">insert</span> <span class="k">into</span> <span class="n">tmp</span> <span class="k">values</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&#34;</span><span class="s2">张三</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="p">,</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&#34;</span><span class="s2">李四</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="p">,</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&#34;</span><span class="s2">王五</span><span class="s2">&#34;</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">update</span> <span class="k">user</span><span class="p">,</span> <span class="n">tmp</span> <span class="k">set</span> <span class="k">user</span><span class="p">.</span><span class="n">name</span><span class="o">=</span><span class="n">tmp</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="k">user</span><span class="p">.</span><span class="n">age</span><span class="o">=</span><span class="n">tmp</span><span class="p">.</span><span class="n">age</span> <span class="k">where</span> <span class="k">user</span><span class="p">.</span><span class="n">id</span><span class="o">=</span><span class="n">tmp</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>
</code></pre></div></li>
</ol>
<p>补充：</p>
<pre><code>// 批量替换字段内容的一部分
mysql&gt; UPDATE article SET content = REPLACE(content, 'abc', '123');
//效果： &quot;AabcB&quot; =》&quot;A123B&quot;
</code></pre><h2 id="delete">delete语法</h2>
<h3 id="heading11">普通删除：</h3>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">DELETE</span> <span class="p">[</span> <span class="n">LOW_PRIORITY</span> <span class="p">]</span> <span class="p">[</span> <span class="n">QUICK</span> <span class="p">]</span> <span class="p">[</span> <span class="k">IGNORE</span> <span class="p">]</span>
<span class="k">FROM</span>
	<span class="n">tbl_name</span> <span class="p">[</span> <span class="n">PARTITION</span> <span class="p">(</span>
		<span class="n">partition_name</span> <span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">)</span> <span class="p">]</span> <span class="p">[</span>
		<span class="k">WHERE</span>
			<span class="n">where_condition</span> <span class="p">]</span> <span class="p">[</span>
		<span class="k">ORDER</span> <span class="k">BY</span>
			<span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">]</span> <span class="p">[</span>
		<span class="k">LIMIT</span> <span class="k">row_count</span> <span class="p">]</span>

<span class="o">/</span><span class="o">/</span><span class="n">eg1</span> <span class="err">删</span><span class="err">除</span><span class="err">单</span><span class="err">条</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">DELETE</span> <span class="k">FROM</span> <span class="k">user</span> <span class="k">where</span> <span class="n">user_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="o">/</span><span class="o">/</span><span class="n">eg2</span> <span class="err">删</span><span class="err">除</span><span class="err">多</span><span class="err">条</span><span class="p">:</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">DELETE</span> <span class="k">FROM</span> <span class="k">user</span> <span class="k">where</span> <span class="n">user_id</span> <span class="k">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="p">;</span>
</code></pre></div><h3 id="heading12">多表删除：</h3>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">DELETE</span> <span class="p">[</span> <span class="n">LOW_PRIORITY</span> <span class="p">]</span> <span class="p">[</span> <span class="n">QUICK</span> <span class="p">]</span> <span class="p">[</span> <span class="k">IGNORE</span> <span class="p">]</span> <span class="n">tbl_name</span> <span class="p">[</span><span class="p">.</span><span class="o">*</span><span class="p">]</span> <span class="p">[</span><span class="p">,</span> <span class="n">tbl_name</span> <span class="p">[</span><span class="p">.</span><span class="o">*</span><span class="p">]</span><span class="p">]</span><span class="p">.</span><span class="p">.</span><span class="p">.</span>
<span class="k">FROM</span>
	<span class="n">table_references</span> <span class="p">[</span>
<span class="k">WHERE</span>
	<span class="n">where_condition</span> <span class="p">]</span>

<span class="o">/</span><span class="o">/</span><span class="n">eg</span><span class="p">:</span>
<span class="k">DELETE</span> <span class="n">t1</span><span class="p">,</span><span class="n">t2</span>
<span class="k">FROM</span> <span class="n">t1</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">t2</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">t3</span>
<span class="k">WHERE</span>
	<span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span>
<span class="k">AND</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">t3</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>
</code></pre></div><p>or:</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">DELETE</span> <span class="p">[</span> <span class="n">LOW_PRIORITY</span> <span class="p">]</span> <span class="p">[</span> <span class="n">QUICK</span> <span class="p">]</span> <span class="p">[</span> <span class="k">IGNORE</span> <span class="p">]</span>
<span class="k">FROM</span>
	<span class="n">tbl_name</span> <span class="p">[</span><span class="p">.</span><span class="o">*</span><span class="p">]</span> <span class="p">[</span><span class="p">,</span> <span class="n">tbl_name</span> <span class="p">[</span><span class="p">.</span><span class="o">*</span><span class="p">]</span><span class="p">]</span><span class="p">.</span><span class="p">.</span><span class="p">.</span> <span class="k">USING</span> <span class="n">table_references</span> <span class="p">[</span>
<span class="k">WHERE</span>
	<span class="n">where_condition</span> <span class="p">]</span>
	
<span class="o">#</span> <span class="n">eg</span><span class="err">：</span>
<span class="k">DELETE</span>
<span class="k">FROM</span>
	<span class="n">t1</span><span class="p">,</span>
	<span class="n">t2</span> <span class="k">USING</span> <span class="n">t1</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">t2</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">t3</span>
<span class="k">WHERE</span>
	<span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span>
<span class="k">AND</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">t3</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>
</code></pre></div><h3 id="heading13">截断表：</h3>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">truncate</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span><span class="p">;</span>
<span class="cm">/*</span><span class="cm">
</span><span class="cm">截断表可以用于删除表中的所有数据。截断表命令还会回收所有索引的分配页。截断表的执行速度与不带where子句的delete（删除）命令相同，甚至比它还要快。delete（删除）一次删除一行数据，并且将每一行被删除的数据都作为一个事务记录日志；而truncate （截断）表则回收整个数据页，只记录很少的日志项。delete（删除）和truncate（截断）都会回收被数据占用的空间，以及相关的索引。只有表的拥有者可以截断表。
</span><span class="cm">另外，truncate表之后，如果有自动主键的话，会恢复成默认值。
</span><span class="cm"></span><span class="cm">*/</span>
</code></pre></div><h2 id="select">select语法</h2>
<h3 id="heading14">基本语法：</h3>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
	<span class="p">[</span> <span class="k">ALL</span> <span class="o">|</span> <span class="k">DISTINCT</span> <span class="o">|</span> <span class="n">DISTINCTROW</span> <span class="p">]</span> <span class="p">[</span> <span class="n">HIGH_PRIORITY</span> <span class="p">]</span> <span class="p">[</span> <span class="n">STRAIGHT_JOIN</span> <span class="p">]</span> <span class="p">[</span> <span class="n">SQL_SMALL_RESULT</span> <span class="p">]</span> <span class="p">[</span> <span class="n">SQL_BIG_RESULT</span> <span class="p">]</span> <span class="p">[</span> <span class="n">SQL_BUFFER_RESULT</span> <span class="p">]</span> <span class="p">[</span> <span class="n">SQL_CACHE</span> <span class="o">|</span> <span class="n">SQL_NO_CACHE</span> <span class="p">]</span> <span class="p">[</span> <span class="n">SQL_CALC_FOUND_ROWS</span> <span class="p">]</span> <span class="n">select_expr</span> <span class="p">[</span><span class="p">,</span> <span class="n">select_expr</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">]</span> <span class="p">[</span>
<span class="k">FROM</span>
	<span class="n">table_references</span> <span class="p">[</span> <span class="n">PARTITION</span> <span class="n">partition_list</span> <span class="p">]</span> <span class="p">[</span>
<span class="k">WHERE</span>
	<span class="n">where_condition</span> <span class="p">]</span> <span class="p">[</span>
<span class="k">GROUP</span> <span class="k">BY</span>
	<span class="err">{</span> <span class="n">col_name</span> <span class="o">|</span> <span class="n">expr</span> <span class="o">|</span> <span class="k">position</span> <span class="err">}</span> <span class="p">[</span> <span class="k">ASC</span> <span class="o">|</span> <span class="k">DESC</span> <span class="p">]</span><span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">[</span> <span class="k">WITH</span> <span class="k">ROLLUP</span> <span class="p">]</span><span class="p">]</span> <span class="p">[</span>
<span class="k">HAVING</span>
	<span class="n">where_condition</span> <span class="p">]</span> <span class="p">[</span>
<span class="k">ORDER</span> <span class="k">BY</span>
	<span class="err">{</span> <span class="n">col_name</span> <span class="o">|</span> <span class="n">expr</span> <span class="o">|</span> <span class="k">position</span> <span class="err">}</span> <span class="p">[</span> <span class="k">ASC</span> <span class="o">|</span> <span class="k">DESC</span> <span class="p">]</span><span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">]</span> <span class="p">[</span>
<span class="k">LIMIT</span> <span class="err">{</span><span class="p">[</span> <span class="k">OFFSET</span> <span class="p">,</span><span class="p">]</span> <span class="k">row_count</span> <span class="o">|</span> <span class="k">row_count</span> <span class="k">OFFSET</span> <span class="k">OFFSET</span> <span class="err">}</span><span class="p">]</span> <span class="p">[</span> <span class="k">PROCEDURE</span> <span class="n">procedure_name</span> <span class="p">(</span><span class="n">argument_list</span><span class="p">)</span> <span class="p">]</span> <span class="p">[</span> <span class="k">INTO</span> <span class="n">OUTFILE</span> <span class="s1">&#39;</span><span class="s1">file_name</span><span class="s1">&#39;</span> <span class="p">[</span> <span class="nb">CHARACTER</span>
<span class="k">SET</span> <span class="n">charset_name</span> <span class="p">]</span> <span class="n">export_options</span> <span class="o">|</span> <span class="k">INTO</span> <span class="n">DUMPFILE</span> <span class="s1">&#39;</span><span class="s1">file_name</span><span class="s1">&#39;</span> <span class="o">|</span> <span class="k">INTO</span> <span class="n">var_name</span> <span class="p">[</span><span class="p">,</span> <span class="n">var_name</span> <span class="p">]</span><span class="p">]</span> <span class="p">[</span> <span class="k">FOR</span> <span class="k">UPDATE</span> <span class="o">|</span> <span class="k">LOCK</span> <span class="k">IN</span> <span class="k">SHARE</span> <span class="k">MODE</span> <span class="p">]</span><span class="p">]</span>

<span class="o">#</span><span class="n">eg</span><span class="p">:</span>
<span class="o">#</span><span class="err">查</span><span class="err">询</span><span class="err">总</span><span class="err">条</span><span class="err">数</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">test_table</span> <span class="k">WHERE</span> <span class="n">tf_b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="o">#</span><span class="err">倒</span><span class="err">序</span><span class="err">分</span><span class="err">页</span><span class="err">查</span><span class="err">询</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">tf_a</span><span class="p">,</span> <span class="n">tf_b</span> <span class="k">FROM</span> <span class="n">test_table</span> <span class="k">WHERE</span> <span class="n">tf_b</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">tf_a</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">;</span>
</code></pre></div><h3 id="heading15">花式操作</h3>
<pre><code># 创建学生表1
CREATE TABLE `student1` (
  `STUDENT_ID` int(11) NOT NULL AUTO_INCREMENT COMMENT '学生自增长ID',
  `STUDENT_NAME` varchar(30) DEFAULT NULL COMMENT '学生名称',
  `STUDENT_COURSE` varchar(30) DEFAULT NULL COMMENT '学科',
  `STUDENT_SCORE` int(11) DEFAULT NULL COMMENT '成绩',
  PRIMARY KEY (`STUDENT_ID`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='学生表';

# 插入数据
INSERT INTO student1 (
	STUDENT_NAME,
	STUDENT_COURSE,
	STUDENT_SCORE
)
VALUES
	(&quot;张三&quot;, &quot;语文&quot;, 80),
	(&quot;张三&quot;, &quot;数学&quot;, 90),
	(&quot;张三&quot;, &quot;英语&quot;, 85),
	(&quot;李四&quot;, &quot;语文&quot;, 30),
	(&quot;李四&quot;, &quot;数学&quot;, 90),
	(&quot;李四&quot;, &quot;英语&quot;, 100);
</code></pre><table>
<thead>
<tr>
<th align="right">STUDENT_ID</th>
<th align="right">STUDENT_NAME</th>
<th align="right">STUDENT_COURSE</th>
<th align="right">STUDENT_SCORE</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">1</td>
<td align="right">张三</td>
<td align="right">语文</td>
<td align="right">80</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">张三</td>
<td align="right">数学</td>
<td align="right">90</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">张三</td>
<td align="right">英语</td>
<td align="right">85</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">李四</td>
<td align="right">语文</td>
<td align="right">30</td>
</tr>
<tr>
<td align="right">5</td>
<td align="right">李四</td>
<td align="right">数学</td>
<td align="right">90</td>
</tr>
<tr>
<td align="right">6</td>
<td align="right">李四</td>
<td align="right">英语</td>
<td align="right">100</td>
</tr>
</tbody>
</table>
<pre><code># 创建学生表2
CREATE TABLE `student2` (
  `STUDENT_ID` int(11) NOT NULL AUTO_INCREMENT COMMENT '学生自增长ID',
  `STUDENT_NAME` varchar(30) DEFAULT NULL COMMENT '学生名称',
  `STUDENT_TOTAL_SCORE` int(1) DEFAULT NULL COMMENT '总成绩',
  PRIMARY KEY (`STUDENT_ID`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='学生总成绩';
</code></pre><h4 id="heading16">查询并插入</h4>
<p>语法格式</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="err">表</span><span class="err">名</span><span class="mi">1</span><span class="p">(</span><span class="err">字</span><span class="err">段</span><span class="err">列</span><span class="err">表</span><span class="mi">1</span><span class="p">)</span> <span class="k">SELECT</span> <span class="err">字</span><span class="err">段</span><span class="err">列</span><span class="err">表</span><span class="mi">2</span> <span class="k">FROM</span> <span class="err">表</span><span class="err">名</span><span class="mi">2</span> <span class="k">WHERE</span> <span class="err">条</span><span class="err">件</span><span class="err">表</span><span class="err">达</span><span class="err">式</span><span class="p">;</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">#</span> <span class="n">eg</span> <span class="err">用</span><span class="err">一</span><span class="err">条</span><span class="err">语</span><span class="err">句</span><span class="err">查</span><span class="err">询</span><span class="err">出</span><span class="n">student1表中学生总成绩并且降序插入student2表中</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">student2</span> <span class="p">(</span>
	<span class="n">STUDENT_NAME</span><span class="p">,</span>
	<span class="n">STUDENT_TOTAL_SCORE</span>
<span class="p">)</span> <span class="k">SELECT</span>
	<span class="n">STUDENT_NAME</span><span class="p">,</span>
	<span class="k">SUM</span><span class="p">(</span><span class="n">STUDENT_SCORE</span><span class="p">)</span> <span class="k">AS</span> <span class="n">STUDENT_TOTAL_SCORE</span>
<span class="k">FROM</span>
	<span class="n">student1</span>
<span class="k">GROUP</span> <span class="k">BY</span>
	<span class="n">STUDENT_NAME</span>
</code></pre></div><p>运行结果：</p>
<table>
<thead>
<tr>
<th align="right">STUDENT_ID</th>
<th align="right">STUDENT_NAME</th>
<th align="right">STUDENT_TOTAL_SCORE</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">1</td>
<td align="right">张三</td>
<td align="right">255</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">李四</td>
<td align="right">220</td>
</tr>
</tbody>
</table>
<h4 id="heading17">查询并更新</h4>
<p>update时，更新的表不能在set和where中用于子查询,但是可以对多个表进行更新(INNER JOIN)，所以根据这个特性我们来做查询并更新
语法格式：</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">UPDATE</span> <span class="n">table1</span> <span class="n">a</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">table2</span> <span class="n">b</span> <span class="k">on</span> <span class="n">a</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">id</span> <span class="k">set</span> <span class="p">.</span><span class="p">.</span><span class="p">.</span> <span class="k">where</span> <span class="p">.</span><span class="p">.</span><span class="p">.</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">#</span> <span class="n">eg</span><span class="p">:</span> <span class="err">用</span><span class="err">一</span><span class="err">条</span><span class="err">语</span><span class="err">句</span><span class="err">将</span><span class="err">所</span><span class="err">有</span><span class="err">人</span><span class="err">的</span><span class="err">语</span><span class="err">文</span><span class="err">成</span><span class="err">绩</span><span class="err">改</span><span class="err">成</span><span class="mi">95</span>
<span class="k">UPDATE</span> <span class="n">student1</span> <span class="n">a</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="p">(</span>
	<span class="k">SELECT</span>
		<span class="n">STUDENT_ID</span><span class="p">,</span>
		<span class="n">STUDENT_NAME</span><span class="p">,</span>
		<span class="n">STUDENT_COURSE</span><span class="p">,</span>
		<span class="n">STUDENT_SCORE</span>
	<span class="k">FROM</span>
		<span class="n">student1</span>
	<span class="k">WHERE</span>
		<span class="n">STUDENT_COURSE</span> <span class="k">LIKE</span> <span class="s1">&#39;</span><span class="s1">%英语%</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="n">b</span> <span class="k">ON</span> <span class="n">a</span><span class="p">.</span><span class="n">STUDENT_ID</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">STUDENT_ID</span>
<span class="k">SET</span> <span class="n">a</span><span class="p">.</span><span class="n">STUDENT_SCORE</span> <span class="o">=</span> <span class="mi">95</span>
</code></pre></div><h4 id="heading18">查询并删除</h4>
<p>通常查询并删除针对的是表中的重复记录，所以我们首先要查找到重复的记录：</p>
<h5 id="heading19">查找记录</h5>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="err">方</span><span class="err">法</span><span class="err">一</span><span class="p">(</span><span class="err">推</span><span class="err">荐</span><span class="p">)</span><span class="err">：</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span>
	<span class="k">table</span> <span class="n">a</span>
<span class="k">WHERE</span>
	<span class="p">[</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">field1</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">field2</span><span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">)</span><span class="p">]</span> <span class="k">IN</span> <span class="p">(</span>
		<span class="k">SELECT</span>
			<span class="p">[</span><span class="n">field1</span><span class="p">,</span><span class="n">field2</span><span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">]</span>
		<span class="k">FROM</span>
			<span class="k">table</span>
		<span class="k">GROUP</span> <span class="k">BY</span>
			<span class="p">[</span><span class="n">field1</span> <span class="p">,</span><span class="n">field2</span><span class="p">,</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p">]</span>
		<span class="k">HAVING</span>
			<span class="k">Count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
	<span class="p">)</span> 
<span class="err">方</span><span class="err">法</span><span class="err">二</span><span class="err">：</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span>
	<span class="k">table</span> <span class="n">a</span>
<span class="k">WHERE</span>
<span class="p">(</span><span class="p">(</span>  <span class="k">SELECT</span>
    	<span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
    <span class="k">FROM</span>
    	<span class="k">table</span>
    <span class="k">WHERE</span>
    	<span class="n">field1</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">field1</span>
        <span class="k">AND</span> <span class="n">field2</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">field2</span>
        <span class="k">AND</span> <span class="p">.</span><span class="p">.</span><span class="p">.</span>
<span class="p">)</span><span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div><p>eg： ps. 如果需要只显示一条最新记录，则添加a.STUDENT_ID和MAX(STUDENT_ID)。</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="o">#</span> <span class="err">根</span><span class="err">据</span><span class="err">多</span><span class="err">个</span><span class="err">字</span><span class="err">段</span><span class="err">查</span><span class="err">询</span><span class="n">student1</span>
<span class="k">SELECT</span>
	<span class="n">STUDENT_ID</span><span class="p">,</span>
	<span class="n">STUDENT_NAME</span><span class="p">,</span>
	<span class="n">STUDENT_COURSE</span><span class="p">,</span>
	<span class="n">STUDENT_SCORE</span>
<span class="k">FROM</span>
	<span class="n">student1</span> <span class="n">a</span>
<span class="k">WHERE</span>
	<span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">STUDENT_NAME</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">STUDENT_COURSE</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span>
	<span class="o">#</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">STUDENT_NAME</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">STUDENT_COURSE</span><span class="p">,</span><span class="n">a</span><span class="p">.</span><span class="n">STUDENT_ID</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span>
		<span class="k">SELECT</span>
		    <span class="o">#</span> <span class="k">MAX</span><span class="p">(</span><span class="n">STUDENT_ID</span><span class="p">)</span>
			<span class="n">STUDENT_NAME</span><span class="p">,</span>
			<span class="n">STUDENT_COURSE</span>
		<span class="k">FROM</span>
			<span class="n">student1</span>
		<span class="k">GROUP</span> <span class="k">BY</span>
			<span class="n">STUDENT_NAME</span><span class="p">,</span>
			<span class="n">STUDENT_COURSE</span>
		<span class="k">HAVING</span>
			<span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
	<span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span>
	<span class="n">STUDENT_COURSE</span> <span class="k">DESC</span>
</code></pre></div><h5 id="heading20">删除记录</h5>
<p>如上所提，可以得到最新的一条数据，那只保留id最大的一条数据:
两种方法目前手头没有大的数据无法做测试，等以后再比较性能差异。
方法一：</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">student1</span>
<span class="k">WHERE</span>
    <span class="o">#</span> <span class="err">将</span><span class="err">最</span><span class="err">后</span><span class="err">插</span><span class="err">入</span><span class="err">的</span><span class="err">数</span><span class="err">据</span><span class="err">保</span><span class="err">留</span> <span class="err">其</span><span class="err">他</span><span class="err">数</span><span class="err">据</span><span class="err">删</span><span class="err">除</span>
	<span class="n">STUDENT_ID</span>  <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
 		<span class="o">#</span> <span class="err">查</span><span class="err">询</span><span class="err">最</span><span class="err">后</span><span class="err">插</span><span class="err">入</span><span class="err">的</span><span class="err">数</span><span class="err">据</span>
		<span class="k">SELECT</span>
			<span class="k">MAX</span><span class="p">(</span><span class="n">STUDENT_ID</span><span class="p">)</span>
		<span class="k">FROM</span>
			<span class="p">(</span>
				<span class="o">#</span>  <span class="err">查</span><span class="err">询</span><span class="err">出</span><span class="err">重</span><span class="err">复</span><span class="err">数</span><span class="err">据</span>
				<span class="k">SELECT</span>
					<span class="n">STUDENT_ID</span><span class="p">,</span>
					<span class="n">STUDENT_NAME</span><span class="p">,</span>
					<span class="n">STUDENT_COURSE</span><span class="p">,</span>
					<span class="n">STUDENT_SCORE</span>
				<span class="k">FROM</span>
					<span class="n">student1</span> <span class="n">a</span>
				<span class="k">WHERE</span>
					<span class="p">(</span>
						<span class="n">a</span><span class="p">.</span><span class="n">STUDENT_NAME</span><span class="p">,</span>
						<span class="n">a</span><span class="p">.</span><span class="n">STUDENT_COURSE</span>
					<span class="p">)</span> <span class="k">IN</span> <span class="p">(</span>
						<span class="k">SELECT</span>
							<span class="n">STUDENT_NAME</span><span class="p">,</span>
							<span class="n">STUDENT_COURSE</span>
						<span class="k">FROM</span>
							<span class="n">student1</span>
						<span class="k">GROUP</span> <span class="k">BY</span>
							<span class="n">STUDENT_NAME</span><span class="p">,</span>
							<span class="n">STUDENT_COURSE</span>
						<span class="k">HAVING</span>
							<span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
					<span class="p">)</span>
			<span class="p">)</span> <span class="k">AS</span> <span class="n">tmp</span>
		<span class="k">GROUP</span> <span class="k">BY</span>
			<span class="n">STUDENT_NAME</span><span class="p">,</span>
			<span class="n">STUDENT_COURSE</span>
		<span class="k">HAVING</span>
			<span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
	<span class="p">)</span>
</code></pre></div><p>方法二：</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">DELETE</span>
<span class="k">FROM</span>
	<span class="n">student1</span>
<span class="k">WHERE</span>
    <span class="o">#</span><span class="err">查</span><span class="err">出</span><span class="err">重</span><span class="err">复</span><span class="err">数</span><span class="err">据</span>
	<span class="p">(</span>
		<span class="n">STUDENT_NAME</span><span class="p">,</span>
		<span class="n">STUDENT_COURSE</span>
	<span class="p">)</span> <span class="k">IN</span> <span class="p">(</span>
		<span class="k">SELECT</span>
			<span class="n">STUDENT_NAME</span><span class="p">,</span>
			<span class="n">STUDENT_COURSE</span>
		<span class="k">FROM</span>
			<span class="p">(</span>
				<span class="k">SELECT</span>
					<span class="n">STUDENT_NAME</span><span class="p">,</span>
					<span class="n">STUDENT_COURSE</span>
				<span class="k">FROM</span>
					<span class="n">student1</span>
				<span class="k">GROUP</span> <span class="k">BY</span>
					<span class="n">STUDENT_NAME</span><span class="p">,</span>
					<span class="n">STUDENT_COURSE</span>
				<span class="k">HAVING</span>
					<span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
			<span class="p">)</span> <span class="n">s1</span>
	<span class="p">)</span>
<span class="o">#</span> <span class="err">排</span><span class="err">除</span><span class="err">最</span><span class="err">后</span><span class="err">插</span><span class="err">入</span><span class="err">的</span><span class="err">数</span><span class="err">据</span><span class="err">保</span><span class="err">留</span>
<span class="k">AND</span> <span class="n">STUDENT_ID</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
	<span class="k">SELECT</span>
		<span class="n">STUDENT_ID</span>
	<span class="k">FROM</span>
		<span class="p">(</span>
			<span class="k">SELECT</span>
				<span class="k">MAX</span><span class="p">(</span><span class="n">STUDENT_ID</span><span class="p">)</span>
			<span class="k">FROM</span>
				<span class="n">student1</span>
			<span class="k">GROUP</span> <span class="k">BY</span>
				<span class="n">STUDENT_NAME</span><span class="p">,</span>
				<span class="n">STUDENT_COURSE</span>
			<span class="k">HAVING</span>
				<span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
		<span class="p">)</span> <span class="n">s2</span>
<span class="p">)</span><span class="p">;</span>
</code></pre></div>
    </article>
    <footer>
      
        上一篇: <a class="previous" href="https://lpgph.github.io/post/mysql_users/"> MySql操作之用户篇</a>
      
      
        下一篇: <a class="next" href="https://lpgph.github.io/post/mysql_procedure_function_trigger_view/"> MySql之存储过程,函数,触发器,视图</a>
      
    </footer>
  </div>
  <div class="comment-container box-style box-other">
    


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
  <div  id="comment-container">

  </div>
<script>
var gitalk = new Gitalk({
  language: 'zh-CN' ,
  clientID: '86c61da5bfaea99e9f10',
  clientSecret: '3c0524cd32fbe175601f5b964c6a34b6d31b0975',
  repo: 'lpgph.github.io',
  owner: 'lpgph',
  admin: ["lpgph"],
  id: window.location.pathname,      
  distractionFreeMode: false  
})
gitalk.render('comment-container')
</script>


  </div>
 


    <div class="article-toc-panel">
      <div class="article-toc" id="article-toc">
        <strong class="toc-title">文章目录</strong>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#heading">创建和删除</a></li>
    <li><a href="#heading1">查看表</a></li>
    <li><a href="#heading2">表字段</a>
      <ul>
        <li><a href="#heading3">常用字段属性:</a></li>
        <li><a href="#heading4">添加字段</a></li>
        <li><a href="#heading5">修改字段</a></li>
        <li><a href="#heading6">删除字段</a></li>
        <li><a href="#heading7">添加索引</a></li>
        <li><a href="#heading8">删除索引</a></li>
      </ul>
    </li>
    <li><a href="#insert">insert语法</a></li>
    <li><a href="#update">update语法</a>
      <ul>
        <li><a href="#heading9">单条更新：</a></li>
        <li><a href="#heading10">多条更新：</a></li>
      </ul>
    </li>
    <li><a href="#delete">delete语法</a>
      <ul>
        <li><a href="#heading11">普通删除：</a></li>
        <li><a href="#heading12">多表删除：</a></li>
        <li><a href="#heading13">截断表：</a></li>
      </ul>
    </li>
    <li><a href="#select">select语法</a>
      <ul>
        <li><a href="#heading14">基本语法：</a></li>
        <li><a href="#heading15">花式操作</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    </div>

    <div class="btn-panel" id="btn-panel">
        
        <div class="btn-toc" id="btn-toc">
          <button class="btn" onclick="showToc()" title="文章目录" >
            <i class="fa fa-expand"></i>
          </button>
          <aside class="article-toc" id="panel-article-toc">
            <strong class="toc-title">文章目录</strong>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#heading">创建和删除</a></li>
    <li><a href="#heading1">查看表</a></li>
    <li><a href="#heading2">表字段</a>
      <ul>
        <li><a href="#heading3">常用字段属性:</a></li>
        <li><a href="#heading4">添加字段</a></li>
        <li><a href="#heading5">修改字段</a></li>
        <li><a href="#heading6">删除字段</a></li>
        <li><a href="#heading7">添加索引</a></li>
        <li><a href="#heading8">删除索引</a></li>
      </ul>
    </li>
    <li><a href="#insert">insert语法</a></li>
    <li><a href="#update">update语法</a>
      <ul>
        <li><a href="#heading9">单条更新：</a></li>
        <li><a href="#heading10">多条更新：</a></li>
      </ul>
    </li>
    <li><a href="#delete">delete语法</a>
      <ul>
        <li><a href="#heading11">普通删除：</a></li>
        <li><a href="#heading12">多表删除：</a></li>
        <li><a href="#heading13">截断表：</a></li>
      </ul>
    </li>
    <li><a href="#select">select语法</a>
      <ul>
        <li><a href="#heading14">基本语法：</a></li>
        <li><a href="#heading15">花式操作</a></li>
      </ul>
    </li>
  </ul>
</nav>
          </aside>
        </div>
        

        <div class="btn-share" id="btn-share">
          <button class="btn" title="分享">
            <i class="fa fa-share-alt"></i>
          </button>
        </div>
        <div class="btn-top" id="btn-top" >
          <button class="btn" onclick="backToTop()" title="返回顶部" >
            <i class="fa fa-arrow-up"></i>
          </button>
        </div>
    </div>
      <script src="https://lpgph.github.io/js/nav-scroll.js"></script>
      <script>
      $("#article-toc").navScrollSpy({
        navContainer: '#article-toc',
        current:"active",
        scrollSpeed: 50
      });

      $("#panel-article-toc").navScrollSpy({
        navContainer: '#panel-article-toc',
        current:"active",
        scrollSpeed: 50
      });
      </script>
  </div>

        </main>
        
        <footer class="home-footer">
            

  <div class="footer-background">
    <figure class="clouds"></figure>
    <figure class="background"></figure>
    <figure class="foreground"></figure>
  </div>

  <div class="footer" >
    <p class="copyright">
      Copyright © 2017-2019 <a href="https://lpgph.github.io/" title="Dreamcatcher">Dreamcatcher</a>
      &nbsp;&nbsp;|&nbsp;&nbsp;
      <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
    </p>
    <br/>
    <script>
        var now = new Date(); 
        function createtime() { 
            var grt= new Date("2017-01-07T00:00:00Z");
            now.setTime(now.getTime()+250); 
            days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
            hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
            if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
            mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
            seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
            snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
            document.getElementById("timeDate").innerHTML = "本站已勉强存活 "+dnum+" 天 "; 
            document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
        } 
        setInterval("createtime()",250);
    </script>

    <ul class="github-badge">
      <li>
        <a style="color: #fff" rel="license" href="https://hexo.io/" target="_blank" title="由 Hugo 强力驱动">
        <span class="badge-subject">Powered</span><span class="badge-value bg-blue">Hugo</span></a>
      </li>
      <li>
        <a style="color: #fff" rel="license" href="https://github.com/" target="_blank" title="静态网页托管于 GitHub Pages 和 Coding Pages">
        <span class="badge-subject">Hosted</span><span class="badge-value bg-brightgreen">GitHub &amp; Coding</span></a>
      </li>
      
      
      <li>
        <a style="color: #fff" rel="license" href="https://github.com/lpgph/hugo-theme-young" target="_blank" title="站点使用 hugo-theme-young 主题">
        <span class="badge-subject">Theme</span><span class="badge-value bg-blue">hugo-theme-young</span></a>
      </li>
      <li>
        <a style="color: #fff" rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="本站点采用知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议进行许可">
        <span class="badge-subject"><i class="fa fa-copyright"></i></span><span class="badge-value bg-lightgrey">BY-NC-SA 4.0</span></a>
      </li>
      <li>
        <a style="color: #fff" rel="license" href="https://996.icu/" target="_blank" title="支持 996.ICU">
        <span class="badge-subject">Link</span><span class="badge-value bg-red">996.ICU</span></a>
      </li>
      
      
    </ul>
  </div>
        </footer>
    </div>

    



<script src="https://lpgph.github.io/js/main.js"></script>


<script type="text/javascript" color="220,220,220" opacity='1' zIndex="1" count="200" src="https://lpgph.github.io//js/canvas-nest.min.js"></script>

<script src="https://lpgph.github.io//js/piao.js" type="text/javascript"></script>
<script src="https://lpgph.github.io//js/circleMagic.js" type="text/javascript"></script>

<script>

document.addEventListener('DOMContentLoaded', (event) => {
  document.querySelectorAll('pre code').forEach((block) => {
    hljs.highlightBlock(block);
  });
});

$(function(){ 
  $('#app-header').circleMagic({
      radius: 20,
      density: 0.2,
      color: 'rgba(255,255,255, .2)',
      
      clearOffset: 0.3
  });

  
  $('#scroll-down').click(function () {
      backToTop();
  });
})

function backToTop() {
   let endScroll;
    endScroll = $('#app-header').height()+10,
    $('html,body').stop().animate({scrollTop: endScroll}, 1000);
}

function showToc() {
   var  btnToc = $("#btn-toc"), 
      
     tocIcon = $(".btn-toc .btn .fa");

    if(btnToc.hasClass("show")){
      btnToc.removeClass("show");
      tocIcon.removeClass("fa-expand");
      tocIcon.addClass("fa-compress");
    }else{
      btnToc.addClass('show');
      tocIcon.removeClass("fa-compress");
      tocIcon.addClass("fa-expand");
    }
}




var resizeTimer = null;
$(window).resize(function(){
  var homeScroll     = $('#app-header').height()-40,
      docScroll      = $(document).scrollTop(),
       articleToc     = $('#article-toc');

    if(resizeTimer){
        clearTimeout(resizeTimer);
    }
    resizeTimer = setTimeout(function(){
        var showToc = document.body.scrollWidth>1800;
        if (showToc) {
          $('#btn-toc').hide();
            if(homeScroll+50<=docScroll) {
              if (!articleToc.hasClass('fixed')) {
                  articleToc.addClass('fixed')
              }
            }
        }else{
          $('#btn-toc').show();
            if( homeScroll+50 >= docScroll) {
            if (articleToc.hasClass('fixed')) {
                articleToc.removeClass('fixed');
            } 
          }
        }

        if (document.body.scrollWidth<720) {
          $("#live2d-widget").css("opacity","0");
          $("#c_n14").css("opacity","0");
        }else{
          $("#live2d-widget").css("opacity","1");
          $("#c_n14").css("opacity","1");
        }

    },100)
})


var temScroll   = 0;

var scrollTimer = null;

  
  
$(window).scroll( function() { 

var homeScroll     = $('#app-header').height()-40,
    docScroll      = $(document).scrollTop();
    openButton     = $('#openaside'),
    navBtnTitle    = $('#nav-btn-title'),
    articleToc     = $('#article-toc');

    if(scrollTimer){
        clearTimeout(scrollTimer);
    }
    scrollTimer = setTimeout(function(){
          
      if (temScroll < docScroll) { 
        if (homeScroll <= docScroll) { 
            
            if (!openButton.hasClass('navbutton-scroll')) {
                openButton.addClass('navbutton-scroll');
                navBtnTitle.hide();
            }
        }
        var showToc = document.body.scrollWidth>1800;

        if (showToc)
          if(homeScroll+50<=docScroll) {
          if (!articleToc.hasClass('fixed')) {
              articleToc.addClass('fixed')
          }
        }
        if (homeScroll+100<=docScroll) {
          if (!showToc) {
            $('#btn-toc').show();
          }
          $('#btn-share').show();
          $('#btn-top').show();
        }
      } else { 
        if (homeScroll >= docScroll) { 
          
          if (openButton.hasClass('navbutton-scroll')) {
            openButton.removeClass('navbutton-scroll');
            navBtnTitle.show();
          }
        }

        var showToc = document.body.scrollWidth > 1800;

        if (showToc){
          if( homeScroll+70 >= docScroll) {
            if (articleToc.hasClass('fixed')) {
                articleToc.removeClass('fixed');
            } 
          }
        }

        if (homeScroll+100>=docScroll) {
          if (!showToc) {
            $('#btn-toc').hide();
          }
          $('#btn-share').hide();
          $('#btn-top').hide();
        }

      }
      temScroll = docScroll;
    },100)

});
</script>

<script type="text/javascript">
done = false;
$(document).ready(function(){
  $('.navbar').click(function(){
    $('#app-header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('#closeaside'),
      o = $('#openaside');
      u = $("#sideBar")
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
    
    }else
    {
      
      
      
    }
  });

  u.click(function(){
    $('.morph-shape').removeClass('show');
    a.removeClass('show-menu');
    u.css('display', 'none');
    o.css('display', 'block');
    $('body').css("overflow","auto");
  })
  c.click(function(){
    $('.morph-shape').removeClass('show');
    a.removeClass('show-menu');
    u.css('display', 'none');
    o.css('display', 'block');
    $('body').css("overflow","auto");
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.addClass('show-menu');
    $('.morph-shape').addClass('show');
    u.css('display', 'block');
    $('body').css("overflow","hidden");
    m.removeClass('moveMain');
  });
  

  $('form.search').on('submit', function (event) {
    if (false === done) {
      event.preventDefault();
      var orgVal = $(this).find('#search').val();
      $(this).find('#search').val('site:https:\/\/lpgph.github.io\/ ' + orgVal);
      done = true;
      $(this).submit();
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('#openaside'),
      c  = $('#closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
   
     
    
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://b.bshare.cn/barCode?site=weixin&url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});
</script>


<link rel="stylesheet" href="https://lpgph.github.io/plugin/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="https://lpgph.github.io/plugin/fancybox/jquery.fancybox.js"></script>
<script type="text/javascript">
$(document).ready(function(){
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
});
</script>




</body>
</html>